echo "start"
IDK=com.tencent.ig
am force-stop com.tencent.ig
am force-stop com.pubg.krmobile
am force-stop com.rekoo.pubgm
am force-stop com.vng.pubgmobile
am force-stop com.tencent.ig 

rm -rf /data/data/com.google.vrplugins
mkdir /data/data/com.google.vrplugins
mkdir /data/data/com.google.vrplugins/files
mkdir /data/data/com.google.vrplugins/shared_prefs
su -c settings put global block_untrusted_touches 0
am force-stop $IDK
pkill $IDK

iptables -F
iptables --flush
iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT
iptables -t nat -F
iptables -t mangle -F
iptables -X

data=/data/data/$IDK
saved=/data/media/0/Android/data/com.tencent.ig/files/UE4Game/ShadowTrackerExtra/ShadowTrackerExtra/Saved
pak=$saved/Paks

url=https://raw.githubusercontent.com/Idkmalek/Idkmalek/main/OK
if [ ! -e  /data/data/OK ] ; then
curl $url --output /data/data/OK
if [ ! -e  /data/data/OK ] ; then
wget -O /data/data/OK $url
fi
chmod 777 /data/data/OK
fi


rm -rf /data/media/0/Android/data/$IDK/files/UE4Game/ShadowTrackerExtra/ShadowTrackerExtra/Saved/{Logs,MMKV,PufferTmpDir,rawdata,RoleInfo,TableDatas,UpdateInfo}
touch /data/media/0/Android/data/$IDK/files/UE4Game/ShadowTrackerExtra/ShadowTrackerExtra/Saved/{Logs,MMKV,rawdata,RoleInfo,TableDatas,UpdateInfo}
chmod -R 0000 /data/media/0/Android/data/$IDK/files/UE4Game/ShadowTrackerExtra/ShadowTrackerExtra/Saved/{Logs,MMKV,rawdata,RoleInfo,TableDatas,UpdateInfo}
iptables -I OUTPUT -p tcp -m string --string "android.crashsight.wetest.net" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "android.crashsight.wetest.net" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "cloud.gsdk.proximabeta.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "cloud.gsdk.proximabeta.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "cs.mbgame.gamesafe.qq.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "cs.mbgame.gamesafe.qq.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "android.googlesource.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "android.googlesource.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "de.voice.gcloudcs.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "de.voice.gcloudcs.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "cloud.vmp.onezapp.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "cloud.vmp.onezapp.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "anticheatexpert.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "anticheatexpert.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "oth.eve.mdt.qq.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "oth.eve.mdt.qq.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "crashsight.qq.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "crashsight.qq.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "lobby.igamecj.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "lobby.igamecj.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "www.anonymous.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "www.anonymous.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "googlesource.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "googlesource.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "www.wetest.net" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "www.wetest.net" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "crashsight.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "crashsight.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "dl.listdl.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "dl.listdl.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "tencent.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "tencent.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "gcloud.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "gcloud.com" --algo bm -j DROP
iptables -I OUTPUT -p tcp -m string --string "qq.com" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "qq.com" --algo bm -j DROP
iptables -A INPUT -p tcp -m string --string "dl.listdl.com" --algo bm -j DROP
iiptables -A INPUT -s dl.listdl.com -j DROP &>/dev/null;
iptables -A OUTPUT -s dl.listdl.com -j DROP &>/dev/null;
iptables -D OUTPUT -p tcp -m string --string "dl.listdl.com" --algo bm -j DROP
iptables -D INPUT -p tcp -m string --string "dl.listdl.com" --algo bm -j DROP
iiptables -D INPUT -s dl.listdl.com -j DROP &>/dev/null;
iptables -D OUTPUT -s dl.listdl.com -j DROP &>/dev/null;
iptables -I OUTPUT -p tcp -m string --string "1.12.004.25" --algo bm -j DROP
iptables -I INPUT -p tcp -m string --string "1.12.004.25" --algo bm -j DROP
iiptables -I INPUT -s 1.12.004.25 -j DROP &>/dev/null;
iptables -I OUTPUT -s 1.12.004.25 -j DROP &>/dev/null;
iptables -A OUTPUT -p tcp -m string --string "1.12.004.25" --algo bm -j DROP
iptables -A INPUT -p tcp -m string --string "1.12.004.25" --algo bm -j DROP
iiptables -A INPUT -s 1.12.004.25 -j DROP &>/dev/null;
iptables -A OUTPUT -s 1.12.004.25 -j DROP &>/dev/null;
iptables -D OUTPUT -p tcp -m string --string "1.12.004.25" --algo bm -j DROP
iptables -D INPUT -p tcp -m string --string "1.12.004.25" --algo bm -j DROP
iiptables -D INPUT -s 1.12.004.25 -j DROP &>/dev/null;
iptables -D OUTPUT -s 1.12.004.25 -j DROP &>/dev/null;

rm -rf /data/media/0/Android/data/$IDK/*.dat
rm -rf /data/media/0/Android/data/$IDK/files/*.dat
rm -rf /data/media/0/Android/data/$IDK/files/UE4Game/*.dat
rm -rf /data/data/$IDK/files
rm -rf /data/data/$IDK/cache
touch /data/data/$IDK/cache

DUMP() {
  pm dump $1 | grep $2 | tr ' ' '\n' | grep $1 | sed s/$2// | tr -d '\n'
}
lib=`ls -mR $(DUMP $IDK legacyNativeLibraryDir=) | grep : | tr -d : | grep /arm | grep -v sosna`
SAVE(){
cp $lib/$1 $lib/$1.bak
}
RETURN(){
mv $lib/$1.bak $lib/$1
}
rm -rf $lib/{libCrashSight.so,libtgpa.so}
chmod 755 $lib/*

rm -rf /data/media/0/Android/data/$IDK/files/TGPA
am start -n $IDK/com.epicgames.ue4.SplashActivity > /dev/null
while [ ! -e /data/media/0/Android/data/$IDK/files/TGPA ]; do sleep 1; done
su -c /data/data/OK F20


rm -rf /data/data/$IDK/{files,app_bugly,app_crashrecord,app_crashSight}
touch /data/data/$IDK/{files,app_bugly,app_crashrecord,app_crashSight}
chmod 000 /data/data/$IDK/{files,app_bugly,app_crashrecord,app_crashSight}
echo "done"